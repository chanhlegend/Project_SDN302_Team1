<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/friend.css">
</head>
<body>
    <div class="friends-container">
        <h2 class="text-center">B·∫°n B√®</h2>
        <div class="tab-header">
            <div>ƒê∆Ø·ª¢C THEO D√ïI (<%= followers.length %>)</div>
            <div class="active">ƒêANG THEO D√ïI (1)</div>
        </div>
        <button class="add-friend-btn mt-3">‚ûï TH√äM B·∫†N B√à</button>
        <div class="friend-list">
            <% if (followers.length === 0) { %>
                <p class="text-center">Kh√¥ng c√≥ ng∆∞·ªùi theo d√µi n√†o.</p>
            <% } else { %>
                <% followers.forEach(follower => { %>
                    <div class="friend-item" id="<%= follower.followerId._id %>">
                        <img src="<%= follower.followerId.avatar || '/img/avatar.png' %>" alt="User">
                        <span><%= follower.followerId.username %></span>
                        <span class="ms-auto">
                            <button class="btn btn-outline-warning btn-sm" onclick="unfollow('<%= follower.followerId._id %>')">‚úîÔ∏èüë§</button>
                        </span>
                    </div>
                <% }) %>
            <% } %>
        </div>
    </div>
    <div class="continue-shopping">
        <button class="btn btn-dark">CONTINUE SHOPPING</button>
    </div>
</body>

<script>
    function unfollow(followerId) {
    
        fetch(`/follow/unfollow`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ followerId: followerId, followingId: '<%= userId %>' }) 
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert("H·ªßy follow th√†nh c√¥ng!");
                document.getElementById(followerId).remove(); 
            } else {
                alert("C√≥ l·ªói x·∫£y ra khi h·ªßy follow!");
            }
        })
        .catch(error => {
            console.error("Error:", error);
        });
    }
</script>
</html>
